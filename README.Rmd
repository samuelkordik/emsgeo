---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# emsgeo

<!-- badges: start -->
<!-- badges: end -->

emsgeo contains helper functions for working with the geographic/spatial aspect of EMS data. This was prepared for a very specific use case scenario but may be extended further in the future. Collaboration to extend this is welcome!

## Installation

You can install the development version of emsgeo like so:

``` r
devtools::install_github("samuelkordik/emsgeo")
```

## Usage

This package uses data from two sources: GIS shapefiles describing roadways, and EMS CSV files containing ePCR elements. The package was designed around using City of Dallas GIS shapefiles for streets, which can be found [here](https://egis.dallascityhall.com/resources/shapefileDownload.aspx). The EMS CSV files for this package were exported from ImageTrend Elite, but could be sourced from any ePCR with the necessary NEMSIS fields. 

## Example

This is a basic example which shows you how to solve a common problem:

```{r example, echo=TRUE}
library(emsgeo)

## Set filenames for source data and details
mvcs_filename <- here::here("../data/MVCs_Export.csv")
streets_filename <- here::here("../data/STREETS 2/STREETS.shp")
streets_layer <- "STREETS"
mvc_coords = c("scene_lon", "scene_lat")

## Import data
mvcs <- read_mvc_data(mvcs_filename)
streets <- get_streets(streets_filename, streets_layer)
incidents_sf <- incidents_as_sf(mvcs, coords = mvc_coords)

## Complete merge
merged <- merge_mvcs_streets(incidents_sf,
                             streets)


## Save out
readr::write_csv(as.data.frame(merged),
          here::here("../data/merged.csv"),
          append = FALSE)
```
